		SELECT distinct case when charindex('/',trim(right(trim(replace(replace(sources3objectkey,'filevine-7831/docs/',''),left(replace(sources3objectkey,'filevine-7831/docs/',''),charindex('/',replace(sources3objectkey,'filevine-7831/docs/',''))),'')),len(trim(replace(replace(sources3objectkey,'filevine-7831/docs/',''),left(replace(sources3objectkey,'filevine-7831/docs/',''),charindex('/',replace(sources3objectkey,'filevine-7831/docs/',''))),'')))-len(left(trim(replace(replace(sources3objectkey,'filevine-7831/docs/',''),left(replace(sources3objectkey,'filevine-7831/docs/',''),charindex('/',replace(sources3objectkey,'filevine-7831/docs/',''))),'')),charindex('/',trim(replace(replace(sources3objectkey,'filevine-7831/docs/',''),left(replace(sources3objectkey,'filevine-7831/docs/',''),charindex('/',replace(sources3objectkey,'filevine-7831/docs/',''))),'')))))) )) <> 0
	 then replace(left(trim(right(trim(replace(replace(sources3objectkey,'filevine-7831/docs/',''),left(replace(sources3objectkey,'filevine-7831/docs/',''),charindex('/',replace(sources3objectkey,'filevine-7831/docs/',''))),'')),len(trim(replace(replace(sources3objectkey,'filevine-7831/docs/',''),left(replace(sources3objectkey,'filevine-7831/docs/',''),charindex('/',replace(sources3objectkey,'filevine-7831/docs/',''))),'')))-len(left(trim(replace(replace(sources3objectkey,'filevine-7831/docs/',''),left(replace(sources3objectkey,'filevine-7831/docs/',''),charindex('/',replace(sources3objectkey,'filevine-7831/docs/',''))),'')),charindex('/',trim(replace(replace(sources3objectkey,'filevine-7831/docs/',''),left(replace(sources3objectkey,'filevine-7831/docs/',''),charindex('/',replace(sources3objectkey,'filevine-7831/docs/',''))),'')))))) ),charindex('/',trim(right(trim(replace(replace(sources3objectkey,'filevine-7831/docs/',''),left(replace(sources3objectkey,'filevine-7831/docs/',''),charindex('/',replace(sources3objectkey,'filevine-7831/docs/',''))),'')),len(trim(replace(replace(sources3objectkey,'filevine-7831/docs/',''),left(replace(sources3objectkey,'filevine-7831/docs/',''),charindex('/',replace(sources3objectkey,'filevine-7831/docs/',''))),'')))-len(left(trim(replace(replace(sources3objectkey,'filevine-7831/docs/',''),left(replace(sources3objectkey,'filevine-7831/docs/',''),charindex('/',replace(sources3objectkey,'filevine-7831/docs/',''))),'')),charindex('/',trim(replace(replace(sources3objectkey,'filevine-7831/docs/',''),left(replace(sources3objectkey,'filevine-7831/docs/',''),charindex('/',replace(sources3objectkey,'filevine-7831/docs/',''))),'')))))) ))),'/','')
	 else trim(right(trim(replace(replace(sources3objectkey,'filevine-7831/docs/',''),left(replace(sources3objectkey,'filevine-7831/docs/',''),charindex('/',replace(sources3objectkey,'filevine-7831/docs/',''))),'')),len(trim(replace(replace(sources3objectkey,'filevine-7831/docs/',''),left(replace(sources3objectkey,'filevine-7831/docs/',''),charindex('/',replace(sources3objectkey,'filevine-7831/docs/',''))),'')))-len(left(trim(replace(replace(sources3objectkey,'filevine-7831/docs/',''),left(replace(sources3objectkey,'filevine-7831/docs/',''),charindex('/',replace(sources3objectkey,'filevine-7831/docs/',''))),'')),charindex('/',trim(replace(replace(sources3objectkey,'filevine-7831/docs/',''),left(replace(sources3objectkey,'filevine-7831/docs/',''),charindex('/',replace(sources3objectkey,'filevine-7831/docs/',''))),'')))))) )
	 , 
	 end AS clientname
		FROM 		filevineproductionimport.._OklahomaLegalService_Documents___59056
	where sources3objectkey like '% /%' -- 15924
	and __errormessage = 's3 file not found' -- 
	and sources3objectkey like '%closed_files%'